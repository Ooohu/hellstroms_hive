<?xml version="1.0" ?>

<!-- Some basic information, a tag that defines uniquely this analysis, and a topology that also defines it -->
<topology tag="Tutorial" name ="#nu_{e}" def = "1" bdtcut = "( 0.6265, 0, 0, 0, 0, 0)"/> 
<inputdir>../../../toys/</inputdir>
<verbosity> 2 </verbosity> <!--0, minimal; 1, normal message; 2, debug_message --> 

<alias key = "regular" value = "1"/>

<!-- ================================================== PRE-CUTS   ==================================================== -->
<precut def = "el.EnuQE[0]<1250&amp;&amp;el.EnuQE[0]>200" name = "EnuQE Cut"/>
<!-- ================================================== BDT FILES [First the ones that we stack in things]==================================================== -->

<bdtfile filename = "nue_analysis/timing_MC_nue_may07_2.root" tag = "intrinsicnue" Tdir = "" scale = "1.0" signal = "true" weight = "wgt">
	<plotstyle isstack = "true"	color = "(176,207,199)" histstyle = "hist" fillstyle = "1" linecolor = "1" linestyle = "1" legend = "lp" on_top = "true"  plot_name = "Intrinsic #nu_{e}">
	</plotstyle>
    <definition>
        <cut> (backgroundType[0]&gt;0) </cut>
        <cut> (backgroundType[0]&lt;6) </cut>
        <cut> Entry$%2==0 </cut>
    </definition>
	<fixPOT> 2.054E21 </fixPOT>
</bdtfile>
<!--
<bdtfile filename = "nue_analysis/timing_MC_nue_may07_2.root" tag = "nonnue" hist_style = "hist" Tdir = "" col = "(207,94,97)" plot_name = "Others" scale = "1.0" signal = "false" plot_on_top = "false" weight = "wgt">
    <definition>
        <cut> backgroundType[0]&gt;8 </cut>
        <cut> Entry$%2==0 </cut>
    </definition>
	<fixPOT> 2.054E21 </fixPOT>
</bdtfile>

<bdtfile filename = "nue_analysis/timing_MC_dirt_may07_2.root" tag = "dirt" hist_style = "hist" Tdir = "" col = "(137,104,89)" plot_name = "Dirt" scale = "1.0" signal = "false" plot_on_top = "false" weight = "wgt">
    <definition>
        <cut>1 </cut>
    </definition>
	<fixPOT> 4.108E21 </fixPOT>
</bdtfile>

-->


<bdtfile filename = "nue_analysis/timing_data_nue_jul07.root" tag = "data" isdata = "true" >
	<plotstyle color = "(0.2,0.8,0.2)" histstyle = "hist" fillstyle = "3333" legend = "p" plot_name = "Data">
	</plotstyle>
    <definition>
		<cut>1</cut>
    </definition>
	<fixPOT>6.46e20</fixPOT>
   <data type="OnBeam">
   </data>
</bdtfile>



<!--OM-->
<bdtfile filename = "systematic_files/Nuemay06OM_MC_66.root" tag = "NueMC" >
	<systematics systag = "OpticalModel" var = "CV[0]" varname = "XsecxFlux" throw = "66" isCV = "false" isOpticalModel = "true">
	</systematics>
	<definition>
		<cut> #regular# </cut>
	</definition>
	<fixPOT>6.58848e20</fixPOT>
</bdtfile>
<bdtfile filename = "systematic_files/Nuemay06OM_MCCV.root" tag = "NueMC" >
	<systematics systag = "OpticalModel" var = "CV[0]" varname = "CV" throw = "1" isCV = "true" isOpticalModel = "true">
	</systematics>
	<definition>
		<cut> #regular# </cut>
	</definition>
	<fixPOT>43.8925e20</fixPOT>
</bdtfile>

<!-- ================================================== BDT FILES [Now the training files]==================================================== -->
<bdtfile filename = "nue_analysis/timing_MC_nue_may07_2.root" tag = "pi0Train" >
    <definition>
        <cut> backgroundType[0]==9 </cut>
        <cut> ibkgd!=1 </cut>
        <cut> Entry$%2==1 </cut>
    </definition>
    <training>
        <cut> 1 </cut>
     </training>
	<fixPOT> 2.054E21 </fixPOT>
</bdtfile>

<bdtfile filename = "nue_analysis/timing_MC_nue_may07_2.root" tag = "nueTrain" weight = "wgt">
    <definition>
        <cut> (backgroundType[0]&gt;0) </cut>
        <cut> (backgroundType[0]&lt;6) </cut>
        <cut> ibkgd==1 </cut>
        <cut> Entry$%2==1 </cut>
		<cut> MCBEAM.ntp&lt;3</cut>
    </definition>
    <training>
        <cut> 1 </cut>
     </training>
	<fixPOT> 2.054E21 </fixPOT>
</bdtfile>
<!-- ============================================== ACTUAL BDT TMVA Setup ==================================== -->
<mva type="BDT" use="yes" tag = "sample_bdt" name ="nueCCQE_pi0" binning = "(36,0.9,1.0)">
    <method type = "XGBoost" use = "yes">
        <param> n_trees=200</param>
        <param> max_depth=4</param>    
        <param> gamma=1.2</param>          
        <param> tree_method=exact</param>
        <param> n_gpus=0</param>
        <param> objective=binary:logistic</param>
        <param> eval_metric=logloss</param>
        <param> min_child_weight=1</param> 
        <param> eta=0.04</param>      
        <param> subsample=0.3</param> 
        <param> colsample_bytree= 0.95</param>
        <param> verbosity=1</param>
    </method>
    <file
        bkg_train_tag= "pi0Train" 
        bkg_test_tag = "pi0Train"
        bkg_test_cut = "1" 
        sig_train_tag= "nueTrain"
        sig_test_tag = "nueTrain"
        sig_test_cut = "1"
        />
    <scan min = "0.2" max = "0.95" steps="160"/>
</mva>

<!-- ============================================== Variables, BDT training and otherwise ====================================== -->
<!-- 0 (R/500)^2 without systematics -->
<var def = "pow(el.R[0]/500.0,3)" binning="(10,0,1)" unit = "(R/500cm)^{3}" logplot = "false"  training = "0" group = "0" plotheight = "1000" />


